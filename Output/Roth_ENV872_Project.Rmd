---
title: "Ozone in Los Angeles County 1980-2018"
author: "Lindsay Roth"
fontsize: 12pt
output:
  pdf_document:
    fig_caption: yes
    keep_tex: yes
    number_sections: yes
  html_document:
    df_print: paged
mainfont: Times New Roman
geometry: margin=2.54cm
subtitle: https://github.com/lhr12
abstract: This project explores the temporal and spatial trends of tropospheric ozone in Los Angeles County from 1980 to 2018.  Through the use of non-parametric statistical analyses, it was determined that ozone levels had decreased over time between 1980 and 2011, but had increased slightly after 2011 until 2018. There was found to be a significant difference in ozone levels between each season and each month of measurements. Finally, it was determined that ozone levels varied significantly between the sites over the time period.  The Clean Air Act was amended in 1990 is likely the reason for the decline in tropospheric ozone after that year. However, the increasing population in a car-dependent city as well as economic growth following the 2008 Great Recession are likely the cause for the increase in ozone levels after 2011.  Additionally, the higher levels of ozone found inland are likely due to daytime sea-breezes blowing smog away from the coast and trapping it within the surrounding mountain range.  Climate change poses the risk of increasing ozone levels through higher average temperatures. Increasing the proportion of electric and hybrid vehicles on the road will likely help to decrease ozone levels in the future and mitigate the impacts of climate change.
---

<Information in these brackets are used for annotating the RMarkdown file. They will not appear in the final version of the PDF document>

\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

<Setup the global options for the R chunks in your document>



```{r setup, include=FALSE}
# Set your working directory
setwd("~/Documents/MEM 1st Year/Spring 2019/Env_Data_Analytics/ENV_Data_Analytics_Project")

# Load your packages
library(knitr)
library(ggplot2)
library(tidyverse)
library(lubridate)
library(dplyr)
library(viridis)
library(RColorBrewer)
library(colormap)
library(nlme)
library(lsmeans)
library(multcompView)
library(trend)
library(mapview)
library(leaflet)
library(sf)
library(gridExtra)
library(grid)
library(lattice)

# Set your ggplot theme
mytheme <- theme_classic(base_size = 12) +
  theme(axis.text = element_text(color = "black"), 
        legend.position = "top", 
        legend.key.size = unit(0.5, "cm"))
theme_set(mytheme)
```

```{r hidden code, include =FALSE}
O3_1980 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1980_Raw.csv")
O3_1981 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1981_Raw.csv")
O3_1982 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1982_Raw.csv")
O3_1983 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1983_Raw.csv")
O3_1984 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1984_Raw.csv")
O3_1985 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1985_Raw.csv")
O3_1986 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1986_Raw.csv")
O3_1987 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1987_Raw.csv")
O3_1988 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1988_Raw.csv")
O3_1989 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1989_Raw.csv")
O3_1990 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1990_Raw.csv")
O3_1991 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1991_Raw.csv")
O3_1992 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1992_Raw.csv")
O3_1993 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1993_Raw.csv")
O3_1994 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1994_Raw.csv")
O3_1995 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1995_Raw.csv")
O3_1996 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1996_Raw.csv")
O3_1997 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1997_Raw.csv")
O3_1998 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1998_Raw.csv")
O3_1999 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles1999_Raw.csv")
O3_2000 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2000_Raw.csv")
O3_2001 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2001_Raw.csv")
O3_2002 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2002_Raw.csv")
O3_2003 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2003_Raw.csv")
O3_2004 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2004_Raw.csv")
O3_2005 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2005_Raw.csv")
O3_2006 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2006_Raw.csv")
O3_2007 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2007_Raw.csv")
O3_2008 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2008_Raw.csv")
O3_2009 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2009_Raw.csv")
O3_2010 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2010_Raw.csv")
O3_2011 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2011_Raw.csv")
O3_2012 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2012_Raw.csv")
O3_2013 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2013_Raw.csv")
O3_2014 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2014_Raw.csv")
O3_2015 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2015_Raw.csv")
O3_2016 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2016_Raw.csv")
O3_2017 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2017_Raw.csv")
O3_2018 <- read.csv("./Data/Raw/EPAair_O3_LosAngeles2018_Raw.csv")


O3_1980$Date <- as.Date(O3_1980$Date, format = "%m/%d/%Y")
O3_1981$Date <- as.Date(O3_1981$Date, format = "%m/%d/%Y")
O3_1982$Date <- as.Date(O3_1982$Date, format = "%m/%d/%Y")
O3_1983$Date <- as.Date(O3_1983$Date, format = "%m/%d/%Y")
O3_1984$Date <- as.Date(O3_1984$Date, format = "%m/%d/%Y")
O3_1985$Date <- as.Date(O3_1985$Date, format = "%m/%d/%Y")
O3_1986$Date <- as.Date(O3_1986$Date, format = "%m/%d/%Y")
O3_1987$Date <- as.Date(O3_1987$Date, format = "%m/%d/%Y")
O3_1988$Date <- as.Date(O3_1988$Date, format = "%m/%d/%Y")
O3_1989$Date <- as.Date(O3_1989$Date, format = "%m/%d/%Y")
O3_1990$Date <- as.Date(O3_1990$Date, format = "%m/%d/%Y")
O3_1991$Date <- as.Date(O3_1991$Date, format = "%m/%d/%Y")
O3_1992$Date <- as.Date(O3_1992$Date, format = "%m/%d/%Y")
O3_1993$Date <- as.Date(O3_1993$Date, format = "%m/%d/%Y")
O3_1994$Date <- as.Date(O3_1994$Date, format = "%m/%d/%Y")
O3_1995$Date <- as.Date(O3_1995$Date, format = "%m/%d/%Y")
O3_1996$Date <- as.Date(O3_1996$Date, format = "%m/%d/%Y")
O3_1997$Date <- as.Date(O3_1997$Date, format = "%m/%d/%Y")
O3_1998$Date <- as.Date(O3_1998$Date, format = "%m/%d/%Y")
O3_1999$Date <- as.Date(O3_1999$Date, format = "%m/%d/%Y")
O3_2000$Date <- as.Date(O3_2000$Date, format = "%m/%d/%Y")
O3_2001$Date <- as.Date(O3_2001$Date, format = "%m/%d/%Y")
O3_2002$Date <- as.Date(O3_2002$Date, format = "%m/%d/%Y")
O3_2003$Date <- as.Date(O3_2003$Date, format = "%m/%d/%Y")
O3_2004$Date <- as.Date(O3_2004$Date, format = "%m/%d/%Y")
O3_2005$Date <- as.Date(O3_2005$Date, format = "%m/%d/%Y")
O3_2006$Date <- as.Date(O3_2006$Date, format = "%m/%d/%Y")
O3_2007$Date <- as.Date(O3_2007$Date, format = "%m/%d/%Y")
O3_2008$Date <- as.Date(O3_2008$Date, format = "%m/%d/%Y")
O3_2009$Date <- as.Date(O3_2009$Date, format = "%m/%d/%Y")
O3_2010$Date <- as.Date(O3_2010$Date, format = "%m/%d/%Y")
O3_2011$Date <- as.Date(O3_2011$Date, format = "%m/%d/%Y")
O3_2012$Date <- as.Date(O3_2012$Date, format = "%m/%d/%Y")
O3_2013$Date <- as.Date(O3_2013$Date, format = "%m/%d/%Y")
O3_2014$Date <- as.Date(O3_2014$Date, format = "%m/%d/%Y")
O3_2015$Date <- as.Date(O3_2015$Date, format = "%m/%d/%Y")
O3_2016$Date <- as.Date(O3_2016$Date, format = "%m/%d/%Y")
O3_2017$Date <- as.Date(O3_2017$Date, format = "%m/%d/%Y")
O3_2018$Date <- as.Date(O3_2018$Date, format = "%m/%d/%Y")

O3_1980$DAILY_AQI_VALUE <- as.numeric(O3_1980$DAILY_AQI_VALUE)

O3_1980_summary_month <- O3_1980 %>%
  mutate(Year = year(O3_1980$Date)) %>%
  mutate(Month = month(O3_1980$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1981_summary_month <- O3_1981 %>%
  mutate(Year = year(O3_1981$Date)) %>%
  mutate(Month = month(O3_1981$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1982_summary_month <- O3_1982 %>%
  mutate(Year = year(O3_1982$Date)) %>%
  mutate(Month = month(O3_1982$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1983_summary_month <- O3_1983 %>%
  mutate(Year = year(O3_1983$Date)) %>%
  mutate(Month = month(O3_1983$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1984_summary_month <- O3_1984 %>%
  mutate(Year = year(O3_1984$Date)) %>%
  mutate(Month = month(O3_1984$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1985_summary_month <- O3_1985 %>%
  mutate(Year = year(O3_1985$Date)) %>%
  mutate(Month = month(O3_1985$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1986_summary_month <- O3_1986 %>%
  mutate(Year = year(O3_1986$Date)) %>%
  mutate(Month = month(O3_1986$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1987_summary_month <- O3_1987 %>%
  mutate(Year = year(O3_1987$Date)) %>%
  mutate(Month = month(O3_1987$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1988_summary_month <- O3_1988 %>%
  mutate(Year = year(O3_1988$Date)) %>%
  mutate(Month = month(O3_1988$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1989_summary_month <- O3_1989 %>%
  mutate(Year = year(O3_1989$Date)) %>%
  mutate(Month = month(O3_1989$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1990_summary_month <- O3_1990 %>%
  mutate(Year = year(O3_1990$Date)) %>%
  mutate(Month = month(O3_1990$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1991_summary_month <- O3_1991 %>%
  mutate(Year = year(O3_1991$Date)) %>%
  mutate(Month = month(O3_1991$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1992_summary_month <- O3_1992 %>%
  mutate(Year = year(O3_1992$Date)) %>%
  mutate(Month = month(O3_1992$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1993_summary_month <- O3_1993 %>%
  mutate(Year = year(O3_1993$Date)) %>%
  mutate(Month = month(O3_1993$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1994_summary_month <- O3_1994 %>%
  mutate(Year = year(O3_1994$Date)) %>%
  mutate(Month = month(O3_1994$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1995_summary_month <- O3_1995 %>%
  mutate(Year = year(O3_1995$Date)) %>%
  mutate(Month = month(O3_1995$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1996_summary_month <- O3_1996 %>%
  mutate(Year = year(O3_1996$Date)) %>%
  mutate(Month = month(O3_1996$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1997_summary_month <- O3_1997 %>%
  mutate(Year = year(O3_1997$Date)) %>%
  mutate(Month = month(O3_1997$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1998_summary_month <- O3_1998 %>%
  mutate(Year = year(O3_1998$Date)) %>%
  mutate(Month = month(O3_1998$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_1999_summary_month <- O3_1999 %>%
  mutate(Year = year(O3_1999$Date)) %>%
  mutate(Month = month(O3_1999$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2000_summary_month <- O3_2000 %>%
  mutate(Year = year(O3_2000$Date)) %>%
  mutate(Month = month(O3_2000$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2001_summary_month <- O3_2001 %>%
  mutate(Year = year(O3_2001$Date)) %>%
  mutate(Month = month(O3_2001$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2002_summary_month <- O3_2002 %>%
  mutate(Year = year(O3_2002$Date)) %>%
  mutate(Month = month(O3_2002$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2003_summary_month <- O3_2003 %>%
  mutate(Year = year(O3_2003$Date)) %>%
  mutate(Month = month(O3_2003$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2004_summary_month <- O3_2004 %>%
  mutate(Year = year(O3_2004$Date)) %>%
  mutate(Month = month(O3_2004$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2005_summary_month <- O3_2005 %>%
  mutate(Year = year(O3_2005$Date)) %>%
  mutate(Month = month(O3_2005$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2006_summary_month <- O3_2006 %>%
  mutate(Year = year(O3_2006$Date)) %>%
  mutate(Month = month(O3_2006$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2007_summary_month <- O3_2007 %>%
  mutate(Year = year(O3_2007$Date)) %>%
  mutate(Month = month(O3_2007$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2008_summary_month <- O3_2008 %>%
  mutate(Year = year(O3_2008$Date)) %>%
  mutate(Month = month(O3_2008$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2009_summary_month <- O3_2009 %>%
  mutate(Year = year(O3_2009$Date)) %>%
  mutate(Month = month(O3_2009$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2010_summary_month <- O3_2010 %>%
  mutate(Year = year(O3_2010$Date)) %>%
  mutate(Month = month(O3_2010$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2011_summary_month <- O3_2011 %>%
  mutate(Year = year(O3_2011$Date)) %>%
  mutate(Month = month(O3_2011$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2012_summary_month <- O3_2012 %>%
  mutate(Year = year(O3_2012$Date)) %>%
  mutate(Month = month(O3_2012$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2013_summary_month <- O3_2013 %>%
  mutate(Year = year(O3_2013$Date)) %>%
  mutate(Month = month(O3_2013$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2014_summary_month <- O3_2014 %>%
  mutate(Year = year(O3_2014$Date)) %>%
  mutate(Month = month(O3_2014$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2015_summary_month <- O3_2015 %>%
  mutate(Year = year(O3_2015$Date)) %>%
  mutate(Month = month(O3_2015$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2016_summary_month <- O3_2016 %>%
  mutate(Year = year(O3_2016$Date)) %>%
  mutate(Month = month(O3_2016$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2017_summary_month <- O3_2017 %>%
  mutate(Year = year(O3_2017$Date)) %>%
  mutate(Month = month(O3_2017$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))
O3_2018_summary_month <- O3_2018 %>%
  mutate(Year = year(O3_2018$Date)) %>%
  mutate(Month = month(O3_2018$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))

O3_total_month <- rbind(O3_1980_summary_month,O3_1981_summary_month,O3_1982_summary_month,
                  O3_1983_summary_month,O3_1984_summary_month,O3_1985_summary_month,
                  O3_1986_summary_month,O3_1987_summary_month,O3_1988_summary_month,
                  O3_1989_summary_month,O3_1990_summary_month,O3_1991_summary_month,
                  O3_1992_summary_month,O3_1993_summary_month,O3_1994_summary_month,
                  O3_1995_summary_month,O3_1996_summary_month,O3_1997_summary_month,
                  O3_1998_summary_month,O3_1999_summary_month,O3_2000_summary_month,
                  O3_2001_summary_month,O3_2002_summary_month,O3_2003_summary_month,
                  O3_2004_summary_month,O3_2005_summary_month,O3_2006_summary_month,
                  O3_2007_summary_month,O3_2008_summary_month,O3_2009_summary_month,
                  O3_2010_summary_month,O3_2011_summary_month,O3_2012_summary_month,
                  O3_2013_summary_month,O3_2014_summary_month,O3_2015_summary_month,
                  O3_2016_summary_month,O3_2017_summary_month,O3_2018_summary_month)

colnames(O3_total_month) <- c("Site.Name","Month", "Year", "MeanAQI")

O3_total_month_processed <-  O3_total_month %>%
  filter(Site.Name != "") %>%
  filter(Site.Name != "Hawthorne") %>%
  filter(Site.Name != "Compton") %>%
  filter(Site.Name != "Lancaster-Division Street") %>%
  filter(Site.Name != "Long Beach (Hudson)") %>%
  filter(Site.Name != "Lancaster-N. Beech St.") %>%
  filter(Site.Name != "Lancaster-Ponderosa St.") %>%
  filter(Site.Name != "Lancaster-Division Street") %>%
  filter(Site.Name != "LAX Hastings") %>%
  filter(Site.Name != "Lynwood") %>%
  filter(Site.Name != "Pico Rivera #2") %>%
  filter(Site.Name != "Santa Clarita") %>%
  filter(Site.Name != "SITE IS LOCATED ONE HALF MILE EAST OF THE I-57/I-60 INTERCHANGE") %>%
  filter(Site.Name != "SB25 trailer at Hollenbeck School") %>%
  filter(Site.Name != "Santa Clarita-Honby St.") %>%
  filter(Site.Name != "Wilmington-N. Mahar Ave") %>%
  filter(Site.Name != "Palmdale-East Ave S") %>%
  filter(Site.Name != "Lebec") %>%
  filter(Site.Name != "West Los Angeles-Robertson Blvd")

O3_alldata <- rbind(O3_1980,O3_1981,O3_1982,O3_1983,O3_1984,O3_1985,
                  O3_1986,O3_1987,O3_1988,O3_1989,O3_1990,O3_1991,
                  O3_1992,O3_1993,O3_1994,O3_1995,O3_1996,O3_1997,
                  O3_1998,O3_1999,O3_2000,O3_2001,O3_2002,O3_2003,
                  O3_2004,O3_2005,O3_2006,O3_2007,O3_2008,O3_2009,
                  O3_2010,O3_2011,O3_2012,O3_2013,O3_2014,O3_2015,
                  O3_2016,O3_2017,O3_2018)


O3_alldata_processed <- O3_alldata %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  filter(Site.Name != "Hawthorne") %>%
  filter(Site.Name != "Compton") %>%
  filter(Site.Name != "Lancaster-Division Street") %>%
  filter(Site.Name != "Long Beach (Hudson)") %>%
  filter(Site.Name != "Lancaster-N. Beech St.") %>%
  filter(Site.Name != "Lancaster-Ponderosa St.") %>%
  filter(Site.Name != "Lancaster-Division Street") %>%
  filter(Site.Name != "LAX Hastings") %>%
  filter(Site.Name != "Lynwood") %>%
  filter(Site.Name != "Pico Rivera #2") %>%
  filter(Site.Name != "Santa Clarita") %>%
  filter(Site.Name != "SITE IS LOCATED ONE HALF MILE EAST OF THE I-57/I-60 INTERCHANGE") %>%
  filter(Site.Name != "SB25 trailer at Hollenbeck School") %>%
  filter(Site.Name != "Santa Clarita-Honby St.") %>%
  filter(Site.Name != "Wilmington-N. Mahar Ave") %>%
  filter(Site.Name != "Palmdale-East Ave S") %>%
  filter(Site.Name != "Lebec") %>%
  filter(Site.Name != "West Los Angeles-Robertson Blvd") 

O3_alldata_processed$DAILY_AQI_VALUE <- as.numeric(O3_alldata_processed$DAILY_AQI_VALUE)

```


# Research Question and Rationale

<Paragraph detailing the rationale for your analysis. What is the significant application and/or interest in this topic? Connect to environmental topic(s)/challenge(s).>

Ozone (O~3~) in the troposphere is a main component of photochemical smog, which is air pollution associated with chemical reactions driven by sunlight (Sillman, 2003). Ozone can have health impacts on human respiratory systems, as well as negatively affecting forests and agricultural crops (Sillman, 2003). High ozone events are exacerbated by sunshine, high temperatures, light winds, and conditions that suppress vertical atmospheric mixing (Sillman, 2003). Smog is also associated with high levels of automobile emissions containing hydrocarbons and nitrogen oxides (Haagen-Smit, 1952). Therefore, because it experiences high temperatures, plentifly sunshine, low atmospheric mixing, and is predominantly transversed by car, smog has become infamous in the city of Los Angeles (Sillman, 2003; Haagen-Smit, 1952). 

<Paragraph detailing your research question(s) and goals. What do you want to find out? Include a sentence (or a few) on the data set you are using to answer this question - just enough to give your reader an idea of where you are going with the analysis.>

I want to determine through statistical analysis if ozone levels in Los Angeles County have changed temporally and spatially across the county.  I am using daily ozone data collected at various Los Angeles County locations between the years of 1980 and 2018.  This data will provide me the date, location, and AQI value for each day between January 1, 1980 through December 31, 2018.  The AQI is an index used to represent ozone levels in the atmosphere. 

\newpage

# Dataset Information

<Information on how the data set for this analysis were collected, the data contained in the data set, and any important pieces of information that are relevant to your analyses. This section should contain much of same information as the README file for the data set but formatted in a way that is more narrative.>

The data were collected from the EPA's outdoor air quality data website using the Download Daily Data tool. The data were downloaded individually by year, leading to a total of 39 data sets.  Each data set contained the date, the source of the data, the daily 8-hour ozone concentration, the daily AQI value, the site name, and the longitude and latitude of each site, as well as other columns that are of slightly less importance to the study.  Table 1 shows a summary of the raw data structure using the 1980 dataset as an example.

<Add a table that summarizes your data structure. This table can be made in markdown text or inserted as a `kable` function in an R chunk. If the latter, do not include the code used to generate your table.>


```{r Table Head, echo=FALSE, eval=TRUE}
O3_1980_fortable <- O3_1980 %>%
  select(Date, Source, Daily.Max.8.hour.Ozone.Concentration, 
         UNITS, DAILY_AQI_VALUE, Site.Name, SITE_LATITUDE, SITE_LONGITUDE)
?colnames
colnames(O3_1980_fortable) <- c("Date", "Source", "Ozone Concentration", "Units", 
                                "AQI", "Site", "Latitude", "Longitude")
kable(head(O3_1980_fortable, 5), caption = "1980 Raw Data Table")
```


\newpage

# Exploratory Data Analysis and Wrangling

<Include R chunks for 5+ lines of summary code (display code and output), 3+ exploratory graphs (display graphs only), and any wrangling you do to your data set(s).> 

To first explore my data, I looked at a summary of the AQI values for 1980, 1990, 2000, 2010, and 2018 to get an idea of how the minimum, median, mean, and maximum values of ozone levels have changed over time by decade throughout the entire county.

```{r summary code}
summary(O3_1980$DAILY_AQI_VALUE)
summary(O3_1990$DAILY_AQI_VALUE)
summary(O3_2000$DAILY_AQI_VALUE)
summary(O3_2010$DAILY_AQI_VALUE)
summary(O3_2018$DAILY_AQI_VALUE)
```


To wrangle my data, I made summary tables for each of the 39 years of data by summarizing the AQI values and grouping by month. I made sure that all of the dates were classified as dates.  Then, I used rbind to combine all of my summary tables from each year into one large data set. Below is an example of the wrangling process for the year 1980, which was repeated for each year through 2018. I corrected the column names to make my data analysis easier and filtered the full data set to only combine the 9 sites with the most complete data for all of the years. Additionally, I created a master data set of all of the non-summarized years of ozone data and wrangled it in a similar manner to only include the 9 sites. 

```{r data wrangling}
O3_1980$Date <- as.Date(O3_1980$Date, format = "%m/%d/%Y")

O3_1980_summary_month <- O3_1980 %>%
  mutate(Year = year(O3_1980$Date)) %>%
  mutate(Month = month(O3_1980$Date)) %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  group_by(as.character(Site.Name), Month, Year) %>%
  summarise(MeanAQI = mean(as.numeric(DAILY_AQI_VALUE)))

O3_total_month <- rbind(
  O3_1980_summary_month,O3_1981_summary_month,O3_1982_summary_month,
  O3_1983_summary_month,O3_1984_summary_month,O3_1985_summary_month,
  O3_1986_summary_month,O3_1987_summary_month,O3_1988_summary_month,
  O3_1989_summary_month,O3_1990_summary_month,O3_1991_summary_month,
  O3_1992_summary_month,O3_1993_summary_month,O3_1994_summary_month,
  O3_1995_summary_month,O3_1996_summary_month,O3_1997_summary_month,
  O3_1998_summary_month,O3_1999_summary_month,O3_2000_summary_month,
  O3_2001_summary_month,O3_2002_summary_month,O3_2003_summary_month,
  O3_2004_summary_month,O3_2005_summary_month,O3_2006_summary_month,
  O3_2007_summary_month,O3_2008_summary_month,O3_2009_summary_month,
  O3_2010_summary_month,O3_2011_summary_month,O3_2012_summary_month,
  O3_2013_summary_month,O3_2014_summary_month,O3_2015_summary_month,
  O3_2016_summary_month,O3_2017_summary_month,O3_2018_summary_month)

colnames(O3_total_month) <- c("Site.Name","Month", "Year", "MeanAQI")

O3_total_month_processed <-  O3_total_month %>%
  filter(Site.Name != "") %>%
  filter(Site.Name != "Hawthorne") %>%
  filter(Site.Name != "Compton") %>%
  filter(Site.Name != "Lancaster-Division Street") %>%
  filter(Site.Name != "Long Beach (Hudson)") %>%
  filter(Site.Name != "Lancaster-N. Beech St.") %>%
  filter(Site.Name != "Lancaster-Ponderosa St.") %>%
  filter(Site.Name != "Lancaster-Division Street") %>%
  filter(Site.Name != "LAX Hastings") %>%
  filter(Site.Name != "Lynwood") %>%
  filter(Site.Name != "Pico Rivera #2") %>%
  filter(Site.Name != "Santa Clarita") %>%
  filter(Site.Name != "SITE IS LOCATED ONE HALF MILE EAST OF THE I-57/I-60 INTERCHANGE") %>%
  filter(Site.Name != "SB25 trailer at Hollenbeck School") %>%
  filter(Site.Name != "Santa Clarita-Honby St.") %>%
  filter(Site.Name != "Wilmington-N. Mahar Ave") %>%
  filter(Site.Name != "Palmdale-East Ave S") %>%
  filter(Site.Name != "Lebec") %>%
  filter(Site.Name != "West Los Angeles-Robertson Blvd")

O3_alldata <- rbind(O3_1980,O3_1981,O3_1982,O3_1983,O3_1984,O3_1985,
                  O3_1986,O3_1987,O3_1988,O3_1989,O3_1990,O3_1991,
                  O3_1992,O3_1993,O3_1994,O3_1995,O3_1996,O3_1997,
                  O3_1998,O3_1999,O3_2000,O3_2001,O3_2002,O3_2003,
                  O3_2004,O3_2005,O3_2006,O3_2007,O3_2008,O3_2009,
                  O3_2010,O3_2011,O3_2012,O3_2013,O3_2014,O3_2015,
                  O3_2016,O3_2017,O3_2018)


O3_alldata_processed <- O3_alldata %>%
  filter(DAILY_AQI_VALUE != ".") %>%
  filter(Site.Name != "") %>%
  filter(Site.Name != "Hawthorne") %>%
  filter(Site.Name != "Compton") %>%
  filter(Site.Name != "Lancaster-Division Street") %>%
  filter(Site.Name != "Long Beach (Hudson)") %>%
  filter(Site.Name != "Lancaster-N. Beech St.") %>%
  filter(Site.Name != "Lancaster-Ponderosa St.") %>%
  filter(Site.Name != "Lancaster-Division Street") %>%
  filter(Site.Name != "LAX Hastings") %>%
  filter(Site.Name != "Lynwood") %>%
  filter(Site.Name != "Pico Rivera #2") %>%
  filter(Site.Name != "Santa Clarita") %>%
  filter(Site.Name != "SITE IS LOCATED ONE HALF MILE EAST OF THE I-57/I-60 INTERCHANGE") %>%
  filter(Site.Name != "SB25 trailer at Hollenbeck School") %>%
  filter(Site.Name != "Santa Clarita-Honby St.") %>%
  filter(Site.Name != "Wilmington-N. Mahar Ave") %>%
  filter(Site.Name != "Palmdale-East Ave S") %>%
  filter(Site.Name != "Lebec") %>%
  filter(Site.Name != "West Los Angeles-Robertson Blvd") 
```

To explore my data visually, I first wanted to see how the monthly AQI values were distributed.  Figure 1 shows a histogram of the AQI monthly averages, and it was apparent that the data was not normally distributed. To confirm this, Figure 2 is a Q-Q plot of the Monthly AQI means, which shows that the points did not follow the Q-Q line very well, giving me further evidence that the data was not normally distributed. This indicated to me that I would need to perform non-paramentric statistical tests on my data. Finally, Figure 3 is a box plot of all of the monthly AQI averages separated by site showing how ozone differed by location.


```{r exploratory graph1, echo=FALSE, fig.cap="Histogram of monthly AQI averages for all sites 1980-2018"}
explore.hist <- ggplot(O3_total_month_processed) +
  geom_histogram(aes(x= MeanAQI), binwidth = 20) +
  labs(title = "Monthly AQI Averages", x = "Mean AQI Values", y = "Counts")

print(explore.hist)

```


```{r exploratory graph2, echo=FALSE, fig.cap="Q-Q plot of monthly AQI averages for all sites 1980-2018"}
qqnorm(O3_total_month_processed$MeanAQI)
qqline(O3_total_month_processed$MeanAQI)

```


```{r exploratory graph3, echo=FALSE, fig.cap="Boxplot of monthly AQI averages for each site 1980-2018"}
ggplot(O3_total_month_processed) +
  geom_boxplot(aes(x = Site.Name, y = MeanAQI)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = "Site Name", y = "Mean Monthly AQI Value")
```


<Include text sections to accompany these R chunks to explain the reasoning behind your workflow, and the rationale for your approach.>


\newpage

# Analysis
<Include R chunks for 3+ statistical tests (display code and output) and 3+ final visualization graphs (display graphs only).>

<Include text sections to accompany these R chunks to explain the reasoning behind your workflow, rationale for your approach, and the justification of meeting or failing to meet assumptions of tests.>

I ran a series of Mann-Kendall and Pettitt tests to find where the statistically significant breakpoints were in the monthly summary data. First, the Mann-Kendall test on the entire data set showed that there was a significant negative trend for all of the years of ozone data (z = -27.304, n = 3951, p-value < 2.2e-16).  Next, the Pettitt test on the entire data set showed that there was a break point at the year 1995 (U = 2454000, p-value < 2.2e-16).  Mann-Kendall tests on the data before and after the break point showed a significant negative trend between 1980 and 1995 (z = -5.1171, n = 1499, p-value = 3.102e-07) and significant positive trend from 1995 to 2018 (z = 7.2036, n = 2452, p-value = 5.863e-13). A second Pettitt test showed another break point in 2011 (U = 227390, p-value = 1.462e-09). The Mann-Kendall tests showed there was not a significant trend from 1995 to 2011 (z = 1.8849, n = 1790, p-value = 0.05945) and a significant positive trend from 2011 to 2018 (z = 2.9277, n = 662, p-value = 0.003415).  A third Pettitt test showed one more break point at 2016 (U = 18004, p-value = 0.002478).  The Mann-Kendall tests showed there was a significant positive trend from 2011 to 2016 (z = 2.618, n = 486, p-value = 0.008846), and no significant trend between 2016 and 2019  (z = -0.83549, n = 176, p-value = 0.4034).  A final Pettitt test was run on the remaining section to ensure there were no more statistically significant break points in the data remaining (U* = 1387, p-value = 0.2436). 

```{r mann-kendall tests}
mk.test(O3_total_month_processed$MeanAQI)

pettitt.test(O3_total_month_processed$MeanAQI) #change point at 1500

mk.test(O3_total_month_processed$MeanAQI[1:1499])
mk.test(O3_total_month_processed$MeanAQI[1500:3951])

pettitt.test(O3_total_month_processed$MeanAQI[1500:3951]) #change point at 1790 +1500

mk.test(O3_total_month_processed$MeanAQI[1500:3289])
mk.test(O3_total_month_processed$MeanAQI[3290:3951])

pettitt.test(O3_total_month_processed$MeanAQI[3290:3951]) #change point at 3290+ 243

mk.test(O3_total_month_processed$MeanAQI[3290:3775])
mk.test(O3_total_month_processed$MeanAQI[3776:3951])

pettitt.test(O3_total_month_processed$MeanAQI[3776:3951]) #change point not significant
```

I then Ran a Seasonal Mann-Kendall test on the entire data set to determine if there was any statistically significant differences between subsets of each year.  First, I ran a seasonal test with a frequency of 4, representing the 3 months of each annual season.  The results showed a statistically significant difference between all four seasons (p<0.01). Next, I ran a seasonal test with a frequency of 12, representing all 12 months out of the year.  The results showed a statistically significant difference between each of the 12 months out of the year (p<0.01). 

```{r seasonal mann-kendall}

O3_alldata_processed$DAILY_AQI_VALUE <- as.numeric(O3_alldata_processed$DAILY_AQI_VALUE)
O3_alldata_processed_timeseries_season <- ts(O3_alldata_processed$DAILY_AQI_VALUE,
                                start = c(1980, 1) ,frequency = 4)

O3_alldata_season_smk <- smk.test(O3_alldata_processed_timeseries_season)
summary(O3_alldata_season_smk)


O3_alldata_processed_timeseries_month <- ts(O3_alldata_processed$DAILY_AQI_VALUE,
                                start = c(1980, 1) ,frequency = 12)

O3_alldata_month_smk <- smk.test(O3_alldata_processed_timeseries_month)
summary(O3_alldata_month_smk)
```

Finally, since the data was not normally distributed, I ran a Kruskal-Wallis test to determine if there was a significant difference in Ozone concentration between each site.  The results of the test showed that there is a significant difference between the monthly averaged AQI values for each site between 1980 and 2018 (Kruskal-Wallis chi-squared = 102.21, df = 8, p-value < 2.2e-16).

```{r Kruskal-Wallis}
O3_total_month_processed$Site.Name <- as.factor(O3_total_month_processed$Site.Name)
kruskal.test(O3_total_month_processed$MeanAQI, O3_total_month_processed$Site.Name) 
```

Figure 4 shows the summarized monthly AQI values by year.  The green portion of the graph indicates "Good" levels of trophospheric ozone, the yellow portion "Moderate" levels, the orange portion "Unhealthy for sensitive groups", and the red portion "Unhealthy". The blue dashed lines indicate the break points determined by the Pettitt tests.

```{r plot data with break points, echo=FALSE, fig.cap="Monthly AQI averages from 1980 to 2018 with break points"}
AQI.Plot.month <- ggplot(O3_total_month_processed, aes(x = Year, y = MeanAQI)) +
  geom_rect(xmin = 1978, xmax = 2020, ymin = 0, ymax = 50, fill = "darkolivegreen1", alpha = 0.1) +
  geom_rect(xmin = 1978, xmax = 2020, ymin = 51, ymax = 100, fill = "khaki1", alpha = 0.1) +
  geom_rect(xmin = 1978, xmax = 2020, ymin = 101, ymax = 150, fill = "tan1", alpha = 0.1) +
  geom_rect(xmin = 1978, xmax = 2020, ymin = 151, ymax = 200, fill = "red", alpha = 0.1) +
  geom_vline(aes(xintercept = as.numeric("1995")), color = "blue", linetype = 2) +
  geom_vline(aes(xintercept = as.numeric("2011")), color = "blue", linetype = 2) +
  geom_vline(aes(xintercept = as.numeric("2016")), color = "blue", linetype = 2) +
  geom_point() +
  labs(title = "Ozone Concentration in Los Angeles County 1980-2018", 
       y = "Mean Monthly AQI Values", color = "Sites")

print(AQI.Plot.month)
```

Figure 5 shows the summarized monthly AQI values by year and colored by month.  As noted by Sillman, it is expected that the highest ozone levels will be in the hottest months, and the lowest ozone levels will be in the cooler months.  This is clearly seen after 1990 with the blue-green colors having higher ozone levels each year, and the yellow and purple colors having lower ozone levels each year. Between 1980 and 1990, there is not as clear of a distinction between the months and levels of ozone. 


```{r plot data with seasons, echo=FALSE, fig.cap="Monthly AQI averages from 1980 to 2018 by season"}
AQI.Plot.season <- ggplot(O3_total_month_processed, aes(x = Year, y = MeanAQI)) +
  geom_rect(xmin = 1978, xmax = 2020, ymin = 0, ymax = 50, fill = "darkolivegreen1", alpha = 0.1) +
  geom_rect(xmin = 1978, xmax = 2020, ymin = 51, ymax = 100, fill = "khaki1", alpha = 0.1) +
  geom_rect(xmin = 1978, xmax = 2020, ymin = 101, ymax = 150, fill = "tan1", alpha = 0.1) +
  geom_rect(xmin = 1978, xmax = 2020, ymin = 151, ymax = 200, fill = "red", alpha = 0.1) +
  geom_point(aes(color = Month), alpha = 0.7) +
  scale_color_viridis() +
  labs(title = "Ozone Concentration in Los Angeles County 1980-2018 by Season", 
       y = "Mean Monthly AQI Values", color = "Month")

print(AQI.Plot.season)
```

Figures 6-10 show the total daily AQI values for each site in the years 1980, 1990, 2000, 2010, and 2018. From 1980 to 2000, it is easy to see that ozone is decreasing for each site over time.  It seems that for some of the sites between 2000 and 2010 the ozone levels seem to have more concentrated AQI values at lower levels with some extreme events as outliers, but the mean AQI values remain fairly constant. Locations more inland like Reseda, Azusa, Burbank, Glendora, and Pasadena have higher AQI values than sites closer to the coast such as West Los Angeles and Los Angeles-North Main Street.


```{r box plot 1, echo=FALSE, fig.cap="Boxplot of 1980 AQI values by site"}
boxplot1980 <- ggplot(O3_1980) +
  geom_boxplot(aes(x = Site.Name, y = DAILY_AQI_VALUE)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylim(0,250) +
  labs(title = "1980 AQI Values by Site",  x = "Site Name", y = "Daily AQI Value") 
print(boxplot1980)
```


```{r box plot 2, echo=FALSE, fig.cap="Boxplot of 1990 AQI values by site"}
boxplot1990 <- ggplot(O3_1990) +
  geom_boxplot(aes(x = Site.Name, y = DAILY_AQI_VALUE)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylim(0,250) +
  labs(title = "1990 AQI Values by Site", x = "Site Name", y = "Daily AQI Value")
print(boxplot1990)
```


```{r box plot 3, echo=FALSE, fig.cap="Boxplot of 2000 AQI values by site"}
boxplot2000 <- ggplot(O3_2000) +
  geom_boxplot(aes(x = Site.Name, y = DAILY_AQI_VALUE)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylim(0,250) +
  labs(title = "2000 AQI Values by Site", x = "Site Name", y = "Daily AQI Value")
print(boxplot2000)
```


```{r box plot 4, echo=FALSE, fig.cap="Boxplot of 2010 AQI values by site"}
boxplot2010 <- ggplot(O3_2010) +
  geom_boxplot(aes(x = Site.Name, y = DAILY_AQI_VALUE)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylim(0,250) +
  labs(title = "2010 AQI Values by Site", x = "Site Name", y = "Daily AQI Value")
print(boxplot2010)
```


```{r box plot 5, echo=FALSE, fig.cap="Boxplot of 2018 AQI values by site"}
boxplot2018 <- ggplot(O3_2018) +
  geom_boxplot(aes(x = Site.Name, y = DAILY_AQI_VALUE)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylim(0,250) +
  labs(title = "2018 AQI Values by Site", x = "Site Name", y = "Daily AQI Value")
print(boxplot2018)
```


\newpage

# Summary and Conclusions
<Summarize your major findings from your analyses. What conclusions do you draw from your findings? Make sure to apply this to a broader application for the research question you have answered.>

This analysis shows that average ozone levels as well as the intensity of extreme ozone events have decreased overall in Los Angeles County between 1980 and 2018. The implementation of more stringent ozone regulations by way of lowering the NAAQS levels for tropospheric ozone and higher standards for automobile emissions put in place in 1990 as an amendment to the Clean Air Act are likely the reason for this trend (EPA, 2017). However, it also showed that there have been some increasing average ozone levels since 2011.  This may be due to population growth in a city whose transportation is dominated by personal automobiles as well as an increase in economic growth and emissions following the Great Recession of 2008 (Peters et al., 2012). This, combined with rising average annual temperatures as a result of climate change, would likely result in higher levels of ozone throughout the more recent years. Because vehicle emissions are such a large contributor to tropospheric ozone and photochemical smog, increasing the proportion of electric and hybrid vehicles owned and driven by Los Angeles County residents could reduce this effect in the coming decades in order to mitigate the impacts of climate change. 


Additionally, there were found to be higher levels of ozone at inland measurement sites compared to those closer to the coast.  This could be attributed to the unique geographic composition of Los Angeles County. The daytime sea breeze blows smog away from the coast, where it is then trapped by the surrounding mountain formations, leading to higher levels of ozone around the inner edges of Los Angeles during the day (Lu & Turco, 1996). There were some irregularities in the data between 1980 and 1990, as seen by the lack of seasonality of the graphed data points and the dramatic shift in the range of AQI values.  This could potentially be due to a change in collection methodology around 1990, allowing for more accurate ozone measurements to be taken, but more research into that anomaly is required.  

\newpage

# Sources 
U.S. Environmental Protection Agency (EPA). (2017). Clean Air Act Overview. Retrieved from https://www.epa.gov/clean-air-act-overview/1990-clean-air-act-amendment-summary-title-i

Haagen-Smit, A. J. (1952). Chemistry and physiology of Los Angeles smog. Industrial & Engineering Chemistry, 44(6), 1342-1346.

Lu, R., & Turco, R. P. (1996). Ozone distributions over the Los Angeles basin: Three-dimensional simulations with the SMOG model. Atmospheric Environment, 30(24), 4155-4176.

Peters, G. P., Marland, G., Le Quéré, C., Boden, T., Canadell, J. G., & Raupach, M. R. (2012). Rapid growth in CO 2 emissions after the 2008–2009 global financial crisis. Nature Climate Change, 2(1), 2.

Sillman, S. (2003). Overview: Tropospheric ozone, smog and ozone-NOx-VOC sensitivity. Treatise on Geochemistry.


